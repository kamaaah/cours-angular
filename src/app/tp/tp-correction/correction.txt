

# damienmonchaty  15 h 58 Sujet TP
# Dans un nouveau composant, creer un formulaire qui permet `a
# une personne de saisir son nom, son prenom ainsi qu’un tableau
# de commentaire de taille variable.
# Chaque commentaire est compose d’un titre, un contenu et une
# categorie.
# En cliquant sur Ajouter, les donnees saisies sont affichees en
# bas du formulaire et le formulaire est vide.
# Aucun champ ne doit etre vide a l’ajout, les nom et prenom
#doivent commencer par une lettre majuscule.

## Correction du TP sur 9 => 10 /02/2021   ##
# damienmonchaty  14 h 07
personnes: any = [];
  personneForm = this.fb.group({
    id: [null, Validators.required],
    nom: ['', [Validators.required, this.checkValidator]],
    prenom: ['', [Validators.required, this.checkValidator]],
    commentaires: this.fb.array([ ])
  });
  constructor(private fb: FormBuilder) {
  }
  createCommentaire() : FormGroup {
    return this.fb.group({
      titre: ['', ],
      contenu: ['', ],
      categorie: ['', ],
    })
  }
  get commentaires() {
    return this.personneForm.get('commentaires') as FormArray;
  }
  ajouterCommentaire() {
    this.commentaires.push(this.createCommentaire());
  }
  supprimerCommentaire(i: number) {
    this.commentaires.removeAt(i);
  }
  checkValidator(control: FormControl) {
    let str: string = control.value;
    let regex = /^[A-Z].*$/
    if (regex.test(str)) {
      return null;
    } else {
      return { erreur: 'non valide' };
    }
  }
  get nom() {
    return this.personneForm.get('nom');
  }
  get id() {
    return this.personneForm.get('id');
  }
  get prenom() {
    return this.personneForm.get('prenom');
  }
  ngOnInit(): void {
  }
  afficherTout() {
    this.personnes.push({ ...this.personneForm.value }); 
    this.personneForm.reset(); 
  }


# Partie HTML
<div class="container">
    <div class="jumbotron">
        <h1 class="display-4">Tp Formulaire</h1>
        <p class="lead">Chaque element de notre formulaire est un « FormGroup » </p>
        <p class="lead">Chaque « formGroup » peut contenir 1 ou plusieurs « FormControl » </p>
        <p class="lead">Chaque « FormControl » contient une valeur par défaut et un system de validation. </p>
    </div>
    <div class="row">
        <div class="col-sm">
            <h3>Personne</h3>
            <form [formGroup]="personneForm" #myForm="ngForm" (ngSubmit)='afficherTout()'>
                <div class="form-group">
                    <label for="id">Id:</label>
                    <input class="form-control" type="number" placeholder="Enter Id" name=id formControlName="id">
                </div>
                <div *ngIf="personneForm.controls['id'].invalid && (personneForm.controls['id'].dirty || personneForm.controls['id'].touched)"
                    class="alert alert-danger">
                    <div *ngIf="personneForm.controls['id'].errors?.required">
                        L'identifiant est obligatoire
                    </div>
                </div>
                <div class="form-group">
                    <label for="nom">Nom:</label>
                    <input class="form-control" type="text" placeholder="Enter LastName" name=nom formControlName="nom">
                </div>
                <div *ngIf="personneForm.controls['nom'].invalid && (personneForm.controls['nom'].dirty || personneForm.controls['nom'].touched)"
                    class="alert alert-danger">
                    <div *ngIf="personneForm.controls['nom'].errors?.required">
                        Le nom est obligatoire
                    </div>
                    <div *ngIf="personneForm.controls['nom'].errors?.erreur">
                        Premiere lettre en majuscule
                    </div>
                </div>
                <div class="form-group">
                    <label for="prenom">Prenom:</label>
                    <input class="form-control" type="text" placeholder="Enter FirstName" name=prenom
                        formControlName="prenom">
                </div>
                <div *ngIf="personneForm.controls['prenom'].invalid && (personneForm.controls['prenom'].dirty || personneForm.controls['prenom'].touched)"
                    class="alert alert-danger">
                    <div *ngIf="personneForm.controls['prenom'].errors?.required">
                        Le prenom est obligatoire
                    </div>
                    <div *ngIf="personneForm.controls['prenom'].errors?.erreur">
                        Premiere lettre en majuscule
                    </div>
                </div>
                <button class="btn btn-success" [disabled]='!personneForm.valid'>Envoyer</button>
                <br>
                <br>
                <div formArrayName="commentaires">
                    <h3 style="display: contents;">Commentaires </h3>
                    <button class="btn btn-primary" type=button (click)="ajouterCommentaire()">
                        Ajouter commentaire
                    </button>
                    <div *ngFor="let commentaire of commentaires.controls; let i= index">
                        <div class="" [formGroupName]="i">
                            <div class="form-group">
                                <label for="prenom">Titre:</label>
                                <input class="form-control" placeholder="titre" name="titre" formControlName="titre">
                            </div>
                            <div class="form-group">
                                <label for="prenom">Contenu:</label>
                                <input class="form-control" placeholder="contenu" name="contenu"
                                    formControlName="contenu">
                            </div>
                            <div class="form-group">
                                <label for="prenom">Catégorie:</label>
                                <input class="form-control" placeholder="categorie" name="categorie"
                                    formControlName="categorie">
                            </div>
                            <button class="btn btn-danger" type=button (click)="supprimerCommentaire(i)">
                                Supprimer
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-sm">
            <div>
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Prenom</th>
                            <th scope="col">Nom</th>
                            <th scope="col">Commentaires</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let elt of personnes;">
                            <td>{{ elt.id }}</td>
                            <td>{{ elt.prenom }}</td>
                            <td>{{ elt.nom }}</td>
                            <td *ngFor="let subItem of elt.commentaires">
                                <p><span style="font-weight: bold;padding-right: 5px;">Titre:</span>{{ subItem.titre }}
                                    <span style="font-weight: bold;padding-right: 5px;">Contenu:</span> {{
                                    subItem.contenu }} <span
                                        style="font-weight: bold;padding-right: 5px;">Catégorie:</span>{{
                                    subItem.categorie }}
                                </p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>



## Correction du TP  avec intégration Materails UI sur 9 => 10 /02/2021 ##
<div class="container">
    <mat-card class="example-card" style="padding: 80px;">
        <mat-card-header>
            <div mat-card-avatar class="example-header-image"></div>
            <mat-card-title>Tp Formulaire</mat-card-title>
            <mat-card-subtitle>Chaque element de notre formulaire est un « FormGroup » </mat-card-subtitle>
        </mat-card-header>
    </mat-card>
    <mat-card class="example-card" style="margin-top: 20px;">
        <mat-card-header>
            <div class="row" style="width: 100%;">
                <div class="col-sm">
                    <h1 style="font-weight: bold;">Personne</h1>
                    <form [formGroup]="personneForm" #myForm="ngForm" (ngSubmit)='afficherTout()'>
                        <table class="" cellspacing="0" style="width:100%">
                            <tr>
                                <td>
                                    <mat-form-field style="width:100%">
                                        <input matInput type="number" placeholder="Enter Id" name=id
                                            formControlName="id">
                                        <mat-error
                                            *ngIf="personneForm.controls['id'].invalid && (personneForm.controls['id'].dirty || personneForm.controls['id'].touched)">
                                            <div *ngIf="personneForm.controls['id'].errors?.required">
                                                L'identifiant est obligatoire
                                            </div>
                                        </mat-error>
                                    </mat-form-field>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <mat-form-field style="width:100%">
                                        <input matInput type="text" placeholder="Enter LastName" name=nom
                                            formControlName="nom">
                                        <mat-error
                                            *ngIf="personneForm.controls['nom'].invalid && (personneForm.controls['nom'].dirty || personneForm.controls['nom'].touched)">
                                            <div *ngIf="personneForm.controls['nom'].errors?.required">
                                                Le nom est obligatoire
                                            </div>
                                            <div *ngIf="personneForm.controls['nom'].errors?.erreur">
                                                Premiere lettre en majuscule
                                            </div>
                                        </mat-error>
                                    </mat-form-field>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <mat-form-field style="width:100%">
                                        <input matInput type="text" placeholder="Enter FirstName" name=prenom
                                            formControlName="prenom">
                                        <mat-error
                                            *ngIf="personneForm.controls['prenom'].invalid && (personneForm.controls['prenom'].dirty || personneForm.controls['prenom'].touched)">
                                            <div *ngIf="personneForm.controls['prenom'].errors?.required">
                                                Le prenom est obligatoire
                                            </div>
                                            <div *ngIf="personneForm.controls['prenom'].errors?.erreur">
                                                Premiere lettre en majuscule
                                            </div>
                                        </mat-error>
                                    </mat-form-field>
                                </td>
                            </tr>
                        </table>
                        <br>
                        <br>
                        <button mat-raised-button [disabled]='!personneForm.valid'>Envoyer</button>
                        <br>
                        <br>
                        <div formArrayName="commentaires">
                            <h1 style="display: contents;font-weight: bold;">Commentaires</h1>
                            <button mat-raised-button color="primary" type=button style="margin-left: 10px;"
                                (click)="ajouterCommentaire()">Ajouter commentaire</button>
                            <div *ngFor="let commentaire of commentaires.controls; let i= index">
                                <div class="" [formGroupName]="i">
                                    <table class="" cellspacing="0" style="width:100%">
                                        <tr>
                                            <td>
                                                <mat-form-field style="width:100%">
                                                    <input matInput type="text" placeholder="titre" name="titre"
                                                        formControlName="titre">
                                                </mat-form-field>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <mat-form-field style="width:100%">
                                                    <input matInput type="text" placeholder="contenu" name="contenu"
                                                        formControlName="contenu">
                                                </mat-form-field>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <mat-form-field style="width:100%">
                                                    <input matInput type="text" placeholder="categorie" name="categorie"
                                                        formControlName="categorie">
                                                </mat-form-field>
                                            </td>
                                        </tr>
                                    </table>
                                    <button mat-raised-button color="warn" type=button
                                        (click)="supprimerCommentaire(i)">
                                        Supprimer
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col-sm">
                    <div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Prenom</th>
                                    <th scope="col">Nom</th>
                                    <th scope="col">Commentaires</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let elt of personnes;">
                                    <td>{{ elt.id }}</td>
                                    <td>{{ elt.prenom }}</td>
                                    <td>{{ elt.nom }}</td>
                                    <td *ngFor="let subItem of elt.commentaires">
                                        <p><span style="font-weight: bold;padding-right: 5px;">Titre:</span>{{
                                            subItem.titre }}
                                            <span style="font-weight: bold;padding-right: 5px;">Contenu:</span> {{
                                            subItem.contenu }} <span
                                                style="font-weight: bold;padding-right: 5px;">Catégorie:</span>{{
                                            subItem.categorie }}
                                        </p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </mat-card-header>
    </mat-card>
</div>

## .ts









# damienmonchaty  14 h 33
## Installation du module Materials UI 
# Création du component ==> angular-materials.modules.ts  !! faire attention au modifications dans les fichiers
# table ==> TableComponent et TableDataQource avec les " ! "  
import { NgModule } from '@angular/core';
import { MatAutocompleteModule } from '@angular/material/autocomplete';
import { MatCheckboxModule } from '@angular/material/checkbox';
import { MatDatepickerModule } from '@angular/material/datepicker';
import { MatFormFieldModule } from '@angular/material/form-field';
import { MatInputModule } from '@angular/material/input';
import { MatRadioModule } from '@angular/material/radio';
import { MatSelectModule } from '@angular/material/select';
import { MatSliderModule } from '@angular/material/slider';
import { MatSlideToggleModule } from '@angular/material/slide-toggle';
import { MatListModule } from '@angular/material/list';
import { MatTableModule } from '@angular/material/table';
import { MatButtonModule } from '@angular/material/button';
import { MatCardModule } from '@angular/material/card';
const modules: any[] = [
  MatAutocompleteModule,
  MatCheckboxModule,
  MatDatepickerModule,
  MatFormFieldModule,
  MatInputModule,
  MatRadioModule,
  MatSelectModule,
  MatSliderModule,
  MatSlideToggleModule,
  MatListModule,
  MatTableModule,
  MatButtonModule,
  MatCardModule
];
@NgModule({
  imports: [ ...modules ],
  exports: [ ...modules ]
})
export class AngularMaterialModule {}

